language: node_js

node_js:
  - "5.11"


#http://stackoverflow.com/questions/37267916/how-to-run-aws-configure-in-a-travis-deploy-script
#http://stackoverflow.com/questions/18456611/is-it-possible-to-set-up-travis-to-run-tests-for-several-languages

#services:
#  - docker

script:
  npm run build

before_deploy:
    pip install --user awscli

deploy:
  - provider: script
    script: ~/.local/bin/aws s3 rm s3://mm-ng2-gui --recursive
    skip_cleanup: true
  - provider: s3
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    bucket: "mm-ng2-gui"
    skip_cleanup: true
    local_dir: dist
    acl: public_read
    cache_control: "max-age=21600"


#after_deploy:
#    cloudfront distribution
    
#after_script:
#    publish to docker public repo

# after deploying into s3 - build and publish docker image
#after_deploy:
#  - if [ "$TRAVIS_BRANCH" == "master" ]; then
#      docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
#      docker push USER/REPO;
#    fi

notifications:
    email:
        on_failure: always
